function calculateFrameScores(player){
  const rolls=[];
  player.frames.forEach(f=>{
    [f.input1,f.input2,f.input3].forEach(inp=>{
      if(inp && inp.value!=="") rolls.push(inp.value.toUpperCase());
    });
  });

  const frameScores=[];
  let rollIndex=0;

  for(let f=0; f<10; f++){
    if(rollIndex>=rolls.length) break;
    let first=rolls[rollIndex];
    let second=rolls[rollIndex+1];
    let third=rolls[rollIndex+2];

    const firstVal=convertRoll(first);
    let secondVal = 0;

    if(second==="/"){ // spare logic
      secondVal = 10 - firstVal;
    } else {
      secondVal = convertRoll(second);
    }

    const thirdVal = convertRoll(third);

    let frameScore=0;

    if(f<9){ // frames 1-9
      if(first==="X"){
        // Strike: 10 + next two valid rolls
        const bonus1 = nextValidRoll(rolls, rollIndex+1);
        const bonus2 = nextValidRoll(rolls, rollIndex+2);
        frameScore = 10 + bonus1 + bonus2;
        rollIndex += 1;
      } else if(second==="/"){
        // Spare: 10 + next valid roll
        const bonus = nextValidRoll(rolls, rollIndex+2);
        frameScore = 10 + bonus;
        rollIndex += 2;
      } else {
        frameScore = firstVal + secondVal;
        rollIndex += 2;
      }
    } else { // 10th frame
      frameScore = firstVal + secondVal + thirdVal;
      rollIndex += (third ? 3 : 2);
    }

    frameScores.push(frameScore);
  }

  return frameScores;
}

function nextValidRoll(rolls, start){
  for(let i=start;i<rolls.length;i++){
    const val = rolls[i];
    if(val && val!==""){
      if(val==="X") return 10;
      if(val==="/") return 10; // only used if first roll in frame was a number
      if(val==="-") return 0;
      if(!isNaN(val)) return parseInt(val);
    }
  }
  return 0;
}

function convertRoll(val){
  if(!val) return 0;
  if(val==="X") return 10;
  if(val==="-") return 0;
  if(!isNaN(val)) return parseInt(val);
  return 0;
}
